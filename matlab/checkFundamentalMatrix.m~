pts1 = [
   3.020519301751723   2.596786959172094
   2.621351894036264   2.757951047738636
   3.605800286632482   3.791987038121546
   2.475761663001728   2.340303837863212
   2.746552415058527   3.013370222948234
   2.683418010219510   1.691394650172999
   3.812414245722914   2.044879731424070
   1.948319539540133   3.429684834622727
   3.176411253015324   1.827122055282097
   3.182138632063733   2.429665766838721 ];


pts2 = [ ...
   1.920459921166140   3.034291347636251
   1.533733195053770   3.180365190371057
   2.456364070816144   4.151752011453615
   1.399696530725253   2.783069240578678
   1.650942479317877   3.423627688352502
   1.613597545828692   2.186102119417673
   2.654105419292067   2.549231570092227
   0.841556026244410   3.830470840421660
   2.076636085082961   2.330698186038357
   2.074849087666451   2.882361072224565];

pts1 = 100 * pts1;
pts2 = 100 * pts2;

pts1 = [pts1 ones(size(pts1,1), 1)]';
pts2 = [pts2 ones(size(pts2,1), 1)]';

Fgt = [ ...
  -0.000000837710510  -0.000022207792842   0.004660634536193
   0.000020754689916   0.000000443452588  -0.012405343594436
  -0.004753112593655   0.009718696572695   1.000000000000000];

        F_my1 = ...
        [-1.240528e-06, -2.4659263e-05, 0.0043561663;
         2.3357645e-05, 4.1720361e-07, -0.013281886;
         -0.0044564442, 0.010273063, 1];
     
        F_my2 = ...
        [-4.7419455e-09, -3.8766225e-06, 0.0011870193;
         -3.7750447e-06, 2.8917873e-06, -0.02240199;
         0.0013357102, 0.021094287, 1];

for pt = 1:size (pts1, 2)
    pt
    err1 = sampson_error (pts1(:,pt), pts2(:,pt), Fgt)
    err2 = sampson_error (pts1(:,pt), pts2(:,pt), F_my1)
    err3 = sampson_error (pts1(:,pt), pts2(:,pt), F_my2)
end

norm (err1 - err2)
norm (err1 - err3)

sum (err2)/size(pts1,2)
sum (err2)/size(pts1,2)


function err = sampson_error (pt1, pt2, F)
    F_pt1 = F * pt1;
    F_pt2 = F' * pt2;
    
    err = (pt2' * F_pt1)^2/(F_pt1(1)^2 + F_pt1(2)^2 + F_pt2(1)^2 + F_pt2(2)^2);
end