% best dlt model =
% [1.6062407, 0.30352572, 29.795549;
%  0.69643456, 1.1981785, -44.864567;
%  0.0015171461, 0.00086035166, 1]
% 
% T1
% [0.01383958, 0, -7.4810138;
%  0, 0.0093280328, -3.1174221;
%  0, 0, 1]
% 
% T2
% [0.028359152, 0, -13.428197;
%  0, 0.023604793, -8.1850424;
%  0, 0, 1]
% 
% non minimal model = 
% [-0.26291448, -0.36338279, 365.29395;
%  -0.31825665, 0.02090985, 247.17615;
%  -0.00095402932, -0.00064862915, 0.99999994]

gt_inliers = ...
[618.31260417448823 216.65620026279981 1 512.32235060700191 301.93009435379878 1 1
843.08136507513802 238.6885979583115 1 603.52030119856568 324.24508045899358 1 1
798.58513242422441 34.056798322702548 1 596.50349511671948 237.2646581091845 1 1
341.31835390907452 8.2705940125013715 1 409.40109715308853 198.88903297353349 1 1
367.20821542315707 184.08364411695021 1 409.97130401295317 273.45950117173976 1 1
811.65469790553527 337.03558583915088 1 585.24137625077901 363.14600350294478 1 1
588.17411705618679 546.65349408352347 1 481.11636293682221 437.80209362992997 1 1
167.50798183452972 414.59902318070328 1 312.52134242881965 358.10399650766993 1 1];
pts1 = gt_inliers(:,1:2);
pts2 = gt_inliers(:,4:5);


H = NormalizedDLT (pts1, pts2);
H = H / H(3,3)

pts1 = [pts1 ones(size(pts1,1), 1)]';
pts2 = [pts2 ones(size(pts2,1), 1)]';

est_pts2 = H*pts1;
est_pts2 = est_pts2./est_pts2(3,:);

est_pts1 = H\pts2; % H^(-1)*pts2
est_pts1 = est_pts1./est_pts1(3,:);

errors1 = norm(abs(pts1 - est_pts1));
errors2 = norm(abs(pts2 - est_pts2));

sum (errors1)/size(errors,1)
sum (errors2)/size(errors,1)
keyboard

